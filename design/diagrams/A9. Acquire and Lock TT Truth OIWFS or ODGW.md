```plantuml
!pragma teoz true
!include_many participants.puml
!includesub common.puml!variables
hide unlinked

ocs -> aosq ++: AcquireAndLockTTTruthOIWFSOrODGW
loop For each low order truth WFS

alt OIWFS
aosq -> oiwfsDetector ++: exposure
note left: Take single exposure
return Completed
aosq -> aosq : Check flux
opt If flux not good
aosq -> oiwfsDetector ++: table_jump
note left: Reset window to full size
return Completed
opt If flux still not good
?<- aosq: Exit with error
end
end
else ODGW
aosq -> odgw ++: exposure
note left: Take single exposure
return Completed
aosq -> aosq : Check flux
opt If flux not good
aosq -> odgw ++: table_jump
note left: Reset window to full size
return Completed
opt If flux still not good
?<- aosq: Exit with error
end
end
end

aosq -> rtc ++: $TBD
note left: Compute gradients
return Completed
aosq -> rtc ++: $TBD
note left: Compute average spot position.\nIf necessary, adjust gradient reference vector 
return Completed
aosq -> rtc ++: loopLowTier3
note left: Start LO truth wavefront reconstruction and close loop
return Completed

alt OIWFS
aosq -> oiwfsDetector ++: exposure
note left: Start continuous exposures.\nWindow shrinks according to table.
return Completed
else ODGW
aosq -> odgw ++: exposure
note left: Start continuous exposures.\nWindow shrinks according to table.
return Completed
end

aosq -> rtc ++: algoSetOiwfsOdgw
note left: Start matched filter update process and\nswitch to matched filter when available.
return Completed
end

return Completed

```