```plantuml
!pragma teoz true
!include_many participants.puml
!includesub common.puml!variables
hide unlinked

ocs -> aosq ++: ShutdownAO

group In parallel

group LGSF
aosq -> lgsf ++: setState(STANDBY)
note left: Set LGSF state to STANDBY
return Completed
end

group NFIRAOS
aosq -> rtc ++: shutdown
note left: Shutdown RTC processes
aosq -> ism ++: datum
note left: Datum ISM stages
aosq -> nscu ++: datum
note left: Datum NSCU mirror stage and shutter.
aosq -> timing ++: datum
note left: Datum the timing generator
aosq -> pwfs ++: park
note left: Park PWFS hardware
aosq -> bs ++: datum
note left: Datum beam splitter stage
aosq -> trombone ++: park
note left: Park LGS trombone
aosq -> nsen ++: datum
note left: Datum NSEN optical bench stage
aosq -> ssNgs ++: datum
note left: Datum all SS NGS stages 
aosq -> lgsWfs ++: park
note left: Park LGS WFS hardware
aosq -> ssLgs ++: datum
note left: Datum all SS LGS stages 
aosq -> vnwAdc ++: datum
note left: Datum all VNW ADC stages
aosq -> vnwFsm ++: datum
note left: Datum VNW FSM stage
aosq -> vnwSsm ++: datum
note left: Datum all VNW SSM stages and reset the tip/tilt/focus integrator
aosq -> vnwFieldStop ++: datum
note left: Datum VNW Field Stop stage
aosq -> dm ++: park
note left: Park the DM (flatten the DMs, deactivate the DM's high-voltage outputs)
aosq -> power ++: park
note left: Turn off power to non-essential components
return Completed
& return
& return
& return
& return
& return
& return
& return
& return
& return
& return
& return
& return
& return
& return
& return
& return
end

group RPG
aosq -> rpg ++: shutdown
note left: Shut down RPG processes
return Completed
end

group PSFR
aosq -> psfr ++: configure
note left: Set the PSF-R into automatic mode
return Completed
end

group OIWFS
loop For each OIWFS
aosq -> oiwfsAdc ++: park
note left: Park ADC 
aosq -> oiwfsPoa ++: park
note left: Park POA
return Completed
& return
end
end

end

return Completed
```